<div *ngIf="!componentLoading">
  <div class="alert alert-danger mt-3" role="alert" *ngIf="notFound">
    {{notFound}}
  </div>
  <div class="row" *ngIf="!notFound">
    <div class="col-lg-9">
      <div class="mt-4">
        <h2 class="post-title" [title]="post?.id">{{post?.title}}</h2>
        <span class="text-muted">Posted {{post?.createdAt}} by <a
          routerLink="/user/{{post?.author._id}}">{{post?.author.username}}</a></span>
        <br>
        <small class="text-muted" *ngIf="post?.createdAt != post?.updatedAt">Last
          updated {{post?.updatedAt}}</small>
        <hr>

        <div *ngIf="post.type === 'link'">
          <div class="card">
            <div class="card-body p-1">
              <a class="ml-3" [href]="post?.link"><samp>{{post?.link}}</samp></a>
              <div>
                <small class="text-muted ml-1 font-italic">Note: This link was posted by a user and should be treated
                  with caution.
                </small>
              </div>
            </div>
          </div>
          <hr>
        </div>


        <!-- Post with single image -->
        <img *ngIf="post?.type === 'img' && post?.images.length === 1"
             src="http://localhost:3000/assets/{{post?.images[0]}}"
             class="d-block w-100 post-img" alt="Post image one">

        <!-- Post with multiple images -->
        <div id="carouselIndicators" class="carousel slide" data-ride="carousel"
             *ngIf="post?.type === 'img' && post?.images.length > 1">
          <ol class="carousel-indicators">
            <li data-target="#carouselIndicators" data-slide-to="0" class="active border border-dark"></li>
            <li data-target="#carouselIndicators" data-slide-to="1" class="border border-dark"
                *ngIf="post?.images.length >= 2"></li>
            <li data-target="#carouselIndicators" data-slide-to="2" class="border border-dark"
                *ngIf="post?.images.length === 3"></li>
          </ol>
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img src="http://localhost:3000/assets/{{post?.images[0]}}" class="d-block w-100 post-img"
                   alt="Post image one">
            </div>
            <div class="carousel-item" *ngIf="post?.images.length >= 2">
              <img src="http://localhost:3000/assets/{{post?.images[1]}}" class="d-block w-100 post-img"
                   alt="Post image two">
            </div>
            <div class="carousel-item" *ngIf="post?.images.length === 3">
              <img src="http://localhost:3000/assets/{{post?.images[2]}}" class="d-block w-100 post-img"
                   alt="Post image three">
            </div>
          </div>
          <a class="carousel-control-prev" href="#carouselIndicators" data-slide="prev">
            <span class="carousel-control-prev-icon bg-dark"></span>
          </a>
          <a class="carousel-control-next" href="#carouselIndicators" data-slide="next">
            <span class="carousel-control-next-icon bg-dark"></span>
          </a>
        </div>
        <hr *ngIf="post?.type === 'img'">
        <!-- Post description -->
        <div class="post-description">{{post?.description}}</div>
        <hr *ngIf="post?.description.length !== 0">
        <!-- Comment posting -->
        <app-comment-new></app-comment-new>
        <!-- Comments -->
        <app-comment-list></app-comment-list>
      </div>
    </div>
    <!-- Post details action cards -->
    <div class="col-lg-3 order-lg-last order-first">
      <div class="row">
        <!-- Show Cards below each other on larger screens -->
        <div class="mt-5 pixel-div d-none d-lg-block"></div>
        <div class="col-sm-12 d-none d-lg-block">
          <div class="card mt-3" *ngIf="post?.author.username === getUsername()">
            <div class="card-body">
              <h5 class="card-title">Manage your post</h5>
              <button class="btn btn-secondary btn-block" routerLink="/post/{{post?.id}}/edit">Edit post</button>
              <button class="btn btn-danger btn-block" routerLink="/post/{{post?.id}}/delete">Delete post</button>
            </div>
          </div>
        </div>
        <div class="col-sm-12 d-none d-lg-block">
          <div class="card mt-3">
            <div class="card-body">
              <h5 class="card-title">User action</h5>
              <!-- Like button -->
              <button class="btn btn-success btn-block" (click)="likePost()" [disabled]="!isLoggedIn() || isLoading">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-heart-fill" fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                        d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                </svg>
                <span> {{post?.score}}</span>
              </button>
              <!-- Save button -->
              <button class="btn btn-primary btn-block" (click)="savePost(postIsSaved)" [disabled]="!isLoggedIn()">
          <span *ngIf="!postIsSaved">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bookmark-fill" fill="currentColor"
                 xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd"
                    d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.74.439L8 13.069l-5.26 2.87A.5.5 0 0 1 2 15.5V2z"/>
            </svg>
          </span>
                <span *ngIf="postIsSaved">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bookmark-check-fill" fill="currentColor"
                 xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd"
                    d="M4 0a2 2 0 0 0-2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4zm6.854 5.854a.5.5 0 0 0-.708-.708L7.5 7.793 6.354 6.646a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z"/>
            </svg>
            (Saved)
          </span>
              </button>
              <!-- Share button -->
              <button class="btn btn-info btn-block" (click)="copyShareLink()">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-share-fill" fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg" *ngIf="!copyLink">
                  <path fill-rule="evenodd"
                        d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z"/>
                </svg>
                <span *ngIf="copyLink"> {{copyLink}}</span>
              </button>
            </div>
          </div>
        </div>
        <!-- Show Cards next to each other on smaller screens -->
        <div class="col-sm-6 d-lg-none order-1">
          <div class="card mt-3" *ngIf="post?.author.username === getUsername()">
            <div class="card-body">
              <h5 class="card-title">Manage your post</h5>
              <button class="btn btn-secondary btn-block" routerLink="/post/{{post?.id}}/edit">Edit post</button>
              <button class="btn btn-danger btn-block" routerLink="/post/{{post?.id}}/delete">Delete post</button>
            </div>
          </div>
        </div>
        <div class="col-sm-6 d-lg-none order-0">
          <div class="card mt-3">
            <div class="card-header">
              User action
            </div>
            <div class="card-body">
              <!-- Like button -->
              <button class="btn btn-success btn-block" (click)="likePost()" [disabled]="!isLoggedIn() || isLoading">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-heart-fill" fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                        d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                </svg>
                <span> {{post?.score}}</span>
              </button>
              <!-- Save button -->
              <button class="btn btn-primary btn-block" (click)="savePost(postIsSaved)" [disabled]="!isLoggedIn()">
          <span *ngIf="!postIsSaved">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bookmark-fill" fill="currentColor"
                 xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd"
                    d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.74.439L8 13.069l-5.26 2.87A.5.5 0 0 1 2 15.5V2z"/>
            </svg>
          </span>
                <span *ngIf="postIsSaved">
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bookmark-check-fill" fill="currentColor"
                 xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd"
                    d="M4 0a2 2 0 0 0-2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4zm6.854 5.854a.5.5 0 0 0-.708-.708L7.5 7.793 6.354 6.646a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z"/>
            </svg>
            (Saved)
          </span>
              </button>
              <!-- Share button -->
              <button class="btn btn-info btn-block" (click)="copyShareLink()">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-share-fill" fill="currentColor"
                     xmlns="http://www.w3.org/2000/svg" *ngIf="!copyLink">
                  <path fill-rule="evenodd"
                        d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z"/>
                </svg>
                <span *ngIf="copyLink"> {{copyLink}}</span>
              </button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
<div *ngIf="componentLoading">
  <div class="spinner-border text-secondary loading-spinner">
  </div>
</div>
